import pymysql
from DBUtils.PooledDB import PooledDB


cate_dir={'三明治':'意面披萨',
'东北菜':'地方菜系',
'中亚/中东菜':'东南亚菜',
'中西糕点':'甜品饮品',
'串串香':'火锅串串',
'云南菜':'地方菜系',
'休闲零食':'其他品类',
'便利店':'其他品类',
'兰州拉面':'米粉面馆',
'其他小吃':'特色小吃',
'其他快餐':'快餐便当',
'其他甜品饮品':'甜品饮品',
'其他菜系':'地方菜系',
'其他西餐':'西式料理',
'其他香锅火锅':'火锅串串',
'内蒙菜':'地方菜系',
'冒菜':'麻辣烫冒菜',
'冰淇淋':'甜品饮品',
'冷冻速食':'其他品类',
'凉皮':'米粉面馆',
'创意菜':'地方菜系',
'刺身寿司':'日料寿司',
'包子汤包':'包子粥店',
'北京炸酱面':'米粉面馆',
'北京菜':'地方菜系',
'卤味鸭脖':'鸭脖卤味',
'卤煮火烧':'特色小吃',
'印度菜':'东南亚菜',
'台湾菜':'地方菜系',
'名酒坊':'其他品类',
'咖啡':'甜品饮品',
'咖喱饭':'快餐便当',
'墨西哥菜':'东南亚菜',
'大型超市':'其他品类',
'奶站':'甜品饮品',
'奶茶果汁':'甜品饮品',
'宠物超市':'其他品类',
'家居百货':'其他品类',
'小火锅':'火锅串串',
'小龙虾':'龙虾烧烤',
'川渝火锅':'火锅串串',
'川湘菜':'川湘菜',
'干锅':'香锅干锅',
'徽菜':'地方菜系',
'意大利菜':'西式料理',
'意面':'意面披萨',
'成人用品':'其他品类',
'披萨':'意面披萨',
'排骨饭':'快餐便当',
'新加坡菜':'东南亚菜',
'新疆菜':'地方菜系',
'日式简餐':'日料寿司',
'日本料理':'日料寿司',
'木桶饭':'快餐便当',
'本帮菜':'地方菜系',
'果切':'甜品饮品',
'水果店':'其他品类',
'水果捞':'甜品饮品',
'水站':'其他品类',
'汉堡薯条':'汉堡薯条',
'江浙菜':'地方菜系',
'江西菜':'地方菜系',
'沙县小吃':'特色小吃',
'沙拉':'轻食沙拉',
'沙茶面':'米粉面馆',
'河北菜':'地方菜系',
'河南菜':'地方菜系',
'法国菜':'西式料理',
'泡馍':'特色小吃',
'泰国菜':'东南亚菜',
'浏阳蒸菜':'地方菜系',
'海鲜':'其他品类',
'海鲜水产':'其他品类',
'淮扬菜':'地方菜系',
'清真菜':'地方菜系',
'港式火锅':'火锅串串',
'湖北菜':'地方菜系',
'滋补炖汤':'暖胃粉丝汤',
'火锅烤串食材':'火锅串串',
'炒饭':'快餐便当',
'炸鸡炸串':'炸鸡炸串',
'烤冷面':'特色小吃',
'烤肉拌饭':'快餐便当',
'烤鱼':'龙虾烧烤',
'烤鸭熟食':'鸭脖卤味',
'烧烤':'龙虾烧烤',
'烧腊饭':'快餐便当',
'烧饼':'夹馍饼类',
'热干面':'米粉面馆',
'焖锅':'香锅干锅',
'焗饭':'快餐便当',
'煎饼':'夹馍饼类',
'煲仔饭':'快餐便当',
'牛排':'西式料理',
'牛肉汤':'暖胃粉丝汤',
'牛肉火锅':'火锅串串',
'牛肉饭':'快餐便当',
'瓦罐汤':'暖胃粉丝汤',
'甏肉干饭':'快餐便当',
'甘肃菜':'地方菜系',
'甜品':'甜品饮品',
'生煎':'包子粥店',
'盖浇饭':'快餐便当',
'砂锅':'暖胃粉丝汤',
'社区生鲜店':'其他品类',
'私房菜':'地方菜系',
'章鱼小丸子':'特色小吃',
'米粉米线':'米粉面馆',
'粉丝汤':'暖胃粉丝汤',
'粤菜':'地方菜系',
'粥店':'包子粥店',
'粮油副食':'其他品类',
'糖葫芦':'特色小吃',
'素食':'轻食沙拉',
'绿植':'其他品类',
'羊杂割':'暖胃粉丝汤',
'羊肉汤':'暖胃粉丝汤',
'羊蝎子':'火锅串串',
'美妆个护':'其他品类',
'肉夹馍':'夹馍饼类',
'肉禽蛋品':'其他品类',
'肠粉':'米粉面馆',
'胡辣汤':'暖胃粉丝汤',
'脆皮鸡饭':'快餐便当',
'花甲':'特色小吃',
'茶行':'其他品类',
'茶餐厅':'地方菜系',
'药店':'其他品类',
'葱油饼':'夹馍饼类',
'蒸鸡滋补鸡':'特色小吃',
'蛋糕':'甜品饮品',
'螺蛳粉':'米粉面馆',
'西北菜':'地方菜系',
'西班牙菜':'西式料理',
'豆浆油条':'包子粥店',
'贵州菜':'地方菜系',
'越南菜':'东南亚菜',
'酸辣粉':'米粉面馆',
'重庆小面':'米粉面馆',
'钵钵鸡':'特色小吃',
'铜锅涮肉':'火锅串串',
'锅巴菜':'地方菜系',
'锅贴':'包子粥店',
'陕西菜':'地方菜系',
'面包':'甜品饮品',
'面馆':'米粉面馆',
'韩国料理':'韩式料理',
'韩国炸鸡':'韩式料理',
'韩式烤肉':'韩式料理',
'韩式简餐':'韩式料理',
'饮料冰品':'甜品饮品',
'饺子':'饺子馄饨',
'馄饨抄手':'饺子馄饨',
'马来西亚菜':'东南亚菜',
'驴肉火烧':'夹馍饼类',
'鱼火锅':'火锅串串',
'鲁菜':'地方菜系',
'鲜花':'其他品类',
'鸡公煲':'特色小吃',
'鸡架':'特色小吃',
'麻辣烫':'麻辣烫冒菜',
'麻辣香锅':'香锅干锅',
'黄焖鸡米饭':'快餐便当',
'':'其他品类'
}

city=['shenzhen']
for i in city:
    pool_mapmarkeronline = PooledDB(pymysql, 5, host='bj-cdb-cwu7v42u.sql.tencentcdb.com', user='root', passwd='xmxc1234',
                                    db='mapmarkeronline', port=62864)
    db = pool_mapmarkeronline.connection()
    cur = db.cursor()
    cur1 = db.cursor()

    sql = "SELECT second_cate,id from t_map_client_elm_%s_mark where update_count=13" %i
    sq = []
    cur.execute(sql)
    results = cur.fetchall()
    for row in results:
        cate_name=row[0]
        id=row[1]
        splited=str(cate_name).split(',')

        dict = {}
        for key in splited:
            dict[key] = dict.get(key, 0) + 1
        for key1, value in dict.items():
            if (value == max(dict.values())):
                res=cate_dir.get(key1)
                update_sql = "UPDATE t_map_client_elm_%s_mark set own_set_cate='%s' where id= %d" % (i,res,id)
                cur1.execute(update_sql)

    db.commit()
    # 关闭cursor对象
    cur.close()
    cur1.close()
    # 关闭connection对象
    db.close()